<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Client side WebSocket mocks</title>
  </head>
  <body>
    <h1>Client side WebSocket mocks</h1>
    <p>This is a server-side events example.</p>
    <p>WebSocket message: <span id="websocket-message">None</span></p>
    <button id="get-websocket-message">Get WebSocket message</button>
  </body>
  <script>
    const ws = new WebSocket("wss://somewhere.com:9898/websocket");
    ws.addEventListener("message", (event) => {
      try {
        const parsedMessage = JSON.parse(event.data.toString());
        if (!parsedMessage.message) {
          throw new Error("Message not found");
        }

        document.getElementById("websocket-message").textContent = parsedMessage.message;
      } catch (error) {
        console.log("error", error);
        document.getElementById("websocket-message").textContent = "Error";
      }
    });

    ws.addEventListener("open", () => {
      console.log("WebSocket connection opened", ws.url);
    });

    document.getElementById("get-websocket-message").addEventListener("click", () => {
      ws.send(JSON.stringify({ type: "get_message" }));
    });
  </script>
</html>